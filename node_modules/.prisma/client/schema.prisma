generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // The datasource property `url` is no longer supported in schema files. Move connection URLs for Migrate to `prisma.config.ts` and pass either `adapter` for a direct database connection or `accelerateUrl` for Accelerate to the `PrismaClient` constructor. See https://pris.ly/d/config-datasource and https://pris.ly/d/prisma7-client-config
}

model User {
  id          String       @id @unique @default(uuid())
  name        String
  sap         String       @unique
  password    String
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  occurrences Occurrence[]

  @@map("user")
}

model Occurrence {
  id          String    @id @unique @default(uuid())
  uuid        String    @unique @map("uuid")
  origin      String    @map("origem")
  process     String    @map("processo")
  procedure   String    @map("procedimento")
  responsible String    @map("responsavel")
  description String    @map("ocorrencia")
  note        String    @map("anotacao")
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  userSap     String    @map("user_sap")
  sap         User      @relation(fields: [userSap], references: [sap], onDelete: Cascade)
  products    Product[]

  @@map("ocorrencia")
}

model Product {
  id                String     @id @unique @default(uuid())
  uuid              String     @unique
  product           String     @map("produto")
  quantity          Int        @map("quantidade")
  unit              String     @map("unidade")
  nameOfResponsible String     @map("nome_responsavel")
  occurrenceDate    DateTime   @map("data_ocorrencia")
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
  occurrence        Occurrence @relation(fields: [uuid], references: [uuid], onDelete: Restrict)

  @@map("produto")
}
